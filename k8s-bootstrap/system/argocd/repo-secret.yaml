# @format
# ArgoCD Repository Credentials — SSH Deploy Key
#
# Grants ArgoCD read-only access to the private GitHub repository
# using an SSH Deploy Key instead of a personal access token.
#
# The private key is resolved from SSM by bootstrap-argocd.sh
# during first boot and injected into this secret.
#
# Setup (one-time):
#   1. Generate key: ssh-keygen -t ed25519 -C "argocd-deploy-key" -f deploy-key -N ""
#   2. Add deploy-key.pub to GitHub → Repo → Settings → Deploy Keys (read-only)
#   3. Store private key in SSM: aws ssm put-parameter --name "/k8s/{env}/deploy-key" \
#        --value "$(cat deploy-key)" --type SecureString

apiVersion: v1
kind: Secret
metadata:
  name: repo-cdk-monitoring
  namespace: argocd
  labels:
    argocd.argoproj.io/secret-type: repository
type: Opaque
stringData:
  type: git
  url: git@github.com:Nelson-Lamounier/cdk-monitoring.git
  sshPrivateKey: "${DEPLOY_KEY}"
