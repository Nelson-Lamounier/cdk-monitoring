{"check_type": "cloudformation", "results": {"failed_checks": [{"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/MonitoringEc2Stack-dev.template 2.json", "file_abs_path": "cdk.out/MonitoringEc2Stack-dev.template 2.json", "repo_file_path": "/cdk.out/MonitoringEc2Stack-dev.template 2.json", "file_line_range": [37, 66], "resource": "AWS::Logs::LogGroup.InstanceLogGroupB49DDDE8", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "dev", "ManagedBy": "CDK", "Owner": "team", "Project": "cdk-monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_46", "bc_check_id": "BC_AWS_SECRETS_1", "check_name": "Ensure no hard-coded secrets exist in EC2 user data", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/UserData"]}, "code_block": null, "file_path": "/MonitoringEc2Stack-dev.template 2.json", "file_abs_path": "cdk.out/MonitoringEc2Stack-dev.template 2.json", "repo_file_path": "/cdk.out/MonitoringEc2Stack-dev.template 2.json", "file_line_range": [178, 267], "resource": "AWS::EC2::Instance.MonitoringInstanceF98CDC02", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.EC2Credentials", "fixed_definition": null, "entity_tags": {"Application": "Prometheus-Grafana", "Environment": "dev", "ManagedBy": "CDK", "Name": "monitoring-instance", "Owner": "team", "Project": "cdk-monitoring", "Purpose": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"ImageId": [{"type": "parameters", "name": "SsmParameterValueawsserviceamiamazonlinuxlatestal2023amikernel61x8664C96584B6F00A464EAD1953AFF4B05118Parameter", "path": "cdk.out/MonitoringEc2Stack-dev.template 2.json", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_27", "bc_check_id": "BC_AWS_GENERAL_16", "check_name": "Ensure all data stored in the SQS queue is encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsMasterKeyId"]}, "code_block": null, "file_path": "/Monitoring-Storage-development.template.json", "file_abs_path": "cdk.out/Monitoring-Storage-development.template.json", "repo_file_path": "/cdk.out/Monitoring-Storage-development.template.json", "file_line_range": [288, 325], "resource": "AWS::SQS::Queue.LambdaDlq3949784F", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SQSQueueEncryption", "fixed_definition": null, "entity_tags": {"Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_27", "bc_check_id": "BC_AWS_GENERAL_16", "check_name": "Ensure all data stored in the SQS queue is encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsMasterKeyId"]}, "code_block": null, "file_path": "/Monitoring-Storage-development.template.json", "file_abs_path": "cdk.out/Monitoring-Storage-development.template.json", "repo_file_path": "/cdk.out/Monitoring-Storage-development.template.json", "file_line_range": [362, 399], "resource": "AWS::SQS::Queue.EventBridgeDlq4776D248", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SQSQueueEncryption", "fixed_definition": null, "entity_tags": {"Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/Monitoring-Storage-development.template.json", "file_abs_path": "cdk.out/Monitoring-Storage-development.template.json", "repo_file_path": "/cdk.out/Monitoring-Storage-development.template.json", "file_line_range": [460, 489], "resource": "AWS::Logs::LogGroup.EbsDetachLambdaLogGroup95ACAE5B", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": null, "file_path": "/Monitoring-Storage-development.template.json", "file_abs_path": "cdk.out/Monitoring-Storage-development.template.json", "repo_file_path": "/cdk.out/Monitoring-Storage-development.template.json", "file_line_range": [630, 721], "resource": "AWS::Lambda::Function.EbsDetachLambdaFunctionF75CD4F6", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": {"Component": "Lambda", "Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/Monitoring-VpcStack-development.template.json", "file_abs_path": "cdk.out/Monitoring-VpcStack-development.template.json", "repo_file_path": "/cdk.out/Monitoring-VpcStack-development.template.json", "file_line_range": [662, 691], "resource": "AWS::Logs::LogGroup.FlowLogGroup3E25AA51", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/Shared-Infra-development.template.json", "file_abs_path": "cdk.out/Shared-Infra-development.template.json", "repo_file_path": "/cdk.out/Shared-Infra-development.template.json", "file_line_range": [640, 669], "resource": "AWS::Logs::LogGroup.FlowLogGroup3E25AA51", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_136", "bc_check_id": "BC_AWS_GENERAL_53", "check_name": "Ensure that ECR repositories are encrypted using KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/EncryptionConfiguration/EncryptionType"]}, "code_block": null, "file_path": "/Shared-Infra-development.template.json", "file_abs_path": "cdk.out/Shared-Infra-development.template.json", "repo_file_path": "/cdk.out/Shared-Infra-development.template.json", "file_line_range": [670, 713], "resource": "AWS::ECR::Repository.EcrRepository4D7B3EE1", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.ECRRepositoryEncrypted", "fixed_definition": null, "entity_tags": {"Application": "NextJS", "Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "SharedResource": "true"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-ecr-repositories-are-encrypted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_51", "bc_check_id": "BC_AWS_GENERAL_24", "check_name": "Ensure ECR Image Tags are immutable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ImageTagMutability"]}, "code_block": null, "file_path": "/Shared-Infra-development.template.json", "file_abs_path": "cdk.out/Shared-Infra-development.template.json", "repo_file_path": "/cdk.out/Shared-Infra-development.template.json", "file_line_range": [670, 713], "resource": "AWS::ECR::Repository.EcrRepository4D7B3EE1", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.ECRImmutableTags", "fixed_definition": null, "entity_tags": {"Application": "NextJS", "Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "SharedResource": "true"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-24", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/Monitoring-Compute-development.template.json", "file_abs_path": "cdk.out/Monitoring-Compute-development.template.json", "repo_file_path": "/cdk.out/Monitoring-Compute-development.template.json", "file_line_range": [153, 182], "resource": "AWS::Logs::LogGroup.LaunchTemplateLogGroupA94E3DC4", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_26", "bc_check_id": "BC_AWS_GENERAL_15", "check_name": "Ensure all data stored in the SNS topic is encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsMasterKeyId"]}, "code_block": null, "file_path": "/Monitoring-Compute-development.template.json", "file_abs_path": "cdk.out/Monitoring-Compute-development.template.json", "repo_file_path": "/cdk.out/Monitoring-Compute-development.template.json", "file_line_range": [615, 642], "resource": "AWS::SNS::Topic.ComputeScalingNotifications2099CF6E", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SNSTopicEncryption", "fixed_definition": null, "entity_tags": {"Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-15", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/MonitoringEc2Stack-dev.template.json", "file_abs_path": "cdk.out/MonitoringEc2Stack-dev.template.json", "repo_file_path": "/cdk.out/MonitoringEc2Stack-dev.template.json", "file_line_range": [37, 66], "resource": "AWS::Logs::LogGroup.InstanceLogGroupB49DDDE8", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "dev", "ManagedBy": "CDK", "Owner": "team", "Project": "cdk-monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_46", "bc_check_id": "BC_AWS_SECRETS_1", "check_name": "Ensure no hard-coded secrets exist in EC2 user data", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/UserData"]}, "code_block": null, "file_path": "/MonitoringEc2Stack-dev.template.json", "file_abs_path": "cdk.out/MonitoringEc2Stack-dev.template.json", "repo_file_path": "/cdk.out/MonitoringEc2Stack-dev.template.json", "file_line_range": [178, 260], "resource": "AWS::EC2::Instance.MonitoringInstanceF98CDC02", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.EC2Credentials", "fixed_definition": null, "entity_tags": {"Application": "Prometheus-Grafana", "Environment": "dev", "ManagedBy": "CDK", "Name": "monitoring-instance", "Owner": "team", "Project": "cdk-monitoring", "Purpose": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"ImageId": [{"type": "parameters", "name": "SsmParameterValueawsserviceamiamazonlinuxlatestal2023amikernel61x8664C96584B6F00A464EAD1953AFF4B05118Parameter", "path": "cdk.out/MonitoringEc2Stack-dev.template.json", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-NodeExporterTaskDefStack-development.template.json", "file_abs_path": "cdk.out/NextJS-NodeExporterTaskDefStack-development.template.json", "repo_file_path": "/cdk.out/NextJS-NodeExporterTaskDefStack-development.template.json", "file_line_range": [37, 74], "resource": "AWS::Logs::LogGroup.LogGroupF5B46931", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Component": "NodeExporter-TaskDefinition", "Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Purpose": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/Monitoring-Ec2Stack-dev.template 2.json", "file_abs_path": "cdk.out/Monitoring-Ec2Stack-dev.template 2.json", "repo_file_path": "/cdk.out/Monitoring-Ec2Stack-dev.template 2.json", "file_line_range": [37, 48], "resource": "AWS::Logs::LogGroup.InstanceLogGroupB49DDDE8", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_46", "bc_check_id": "BC_AWS_SECRETS_1", "check_name": "Ensure no hard-coded secrets exist in EC2 user data", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/UserData"]}, "code_block": null, "file_path": "/Monitoring-Ec2Stack-dev.template 2.json", "file_abs_path": "cdk.out/Monitoring-Ec2Stack-dev.template 2.json", "repo_file_path": "/cdk.out/Monitoring-Ec2Stack-dev.template 2.json", "file_line_range": [142, 208], "resource": "AWS::EC2::Instance.MonitoringInstanceF98CDC02", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.EC2Credentials", "fixed_definition": null, "entity_tags": {"Application": "Prometheus-Grafana", "Name": "monitoring-instance", "Purpose": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"ImageId": [{"type": "parameters", "name": "SsmParameterValueawsserviceamiamazonlinuxlatestal2023amikernel61x8664C96584B6F00A464EAD1953AFF4B05118Parameter", "path": "cdk.out/Monitoring-Ec2Stack-dev.template 2.json", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-Api-development.template.json", "file_abs_path": "cdk.out/NextJS-Api-development.template.json", "repo_file_path": "/cdk.out/NextJS-Api-development.template.json", "file_line_range": [353, 390], "resource": "AWS::Logs::LogGroup.ArticlesApiAccessLogs46ED8D57", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "Layer": "API", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "WebappApi"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_120", "bc_check_id": "BC_AWS_GENERAL_128", "check_name": "Ensure API Gateway caching is enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/CacheClusterEnabled"]}, "code_block": null, "file_path": "/NextJS-Api-development.template.json", "file_abs_path": "cdk.out/NextJS-Api-development.template.json", "repo_file_path": "/cdk.out/NextJS-Api-development.template.json", "file_line_range": [466, 540], "resource": "AWS::ApiGateway::Stage.ArticlesApiRestApiDeploymentStageapi08C84436", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.APIGatewayCacheEnable", "fixed_definition": null, "entity_tags": {"Component": "ApiGateway", "Environment": "development", "Layer": "API", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "WebappApi"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-api-gateway-caching-is-enabled", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_59", "bc_check_id": "BC_AWS_PUBLIC_6", "check_name": "Ensure there is no open access to back-end resources through API", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/HttpMethod", "Properties/AuthorizationType", "Properties/ApiKeyRequired"]}, "code_block": null, "file_path": "/NextJS-Api-development.template.json", "file_abs_path": "cdk.out/NextJS-Api-development.template.json", "repo_file_path": "/cdk.out/NextJS-Api-development.template.json", "file_line_range": [744, 793], "resource": "AWS::ApiGateway::Method.ArticlesApiRestApiarticlesGET52C54A61", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.APIGatewayAuthorization", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-6-api-gateway-authorizer-set", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_59", "bc_check_id": "BC_AWS_PUBLIC_6", "check_name": "Ensure there is no open access to back-end resources through API", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/HttpMethod", "Properties/AuthorizationType", "Properties/ApiKeyRequired"]}, "code_block": null, "file_path": "/NextJS-Api-development.template.json", "file_abs_path": "cdk.out/NextJS-Api-development.template.json", "repo_file_path": "/cdk.out/NextJS-Api-development.template.json", "file_line_range": [942, 991], "resource": "AWS::ApiGateway::Method.ArticlesApiRestApiarticlesslugGETB3212F24", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.APIGatewayAuthorization", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-6-api-gateway-authorizer-set", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_59", "bc_check_id": "BC_AWS_PUBLIC_6", "check_name": "Ensure there is no open access to back-end resources through API", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/HttpMethod", "Properties/AuthorizationType", "Properties/ApiKeyRequired"]}, "code_block": null, "file_path": "/NextJS-Api-development.template.json", "file_abs_path": "cdk.out/NextJS-Api-development.template.json", "repo_file_path": "/cdk.out/NextJS-Api-development.template.json", "file_line_range": [1143, 1197], "resource": "AWS::ApiGateway::Method.ArticlesApiRestApisubscriptionsPOST82D3531B", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.APIGatewayAuthorization", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-6-api-gateway-authorizer-set", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_59", "bc_check_id": "BC_AWS_PUBLIC_6", "check_name": "Ensure there is no open access to back-end resources through API", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/HttpMethod", "Properties/AuthorizationType", "Properties/ApiKeyRequired"]}, "code_block": null, "file_path": "/NextJS-Api-development.template.json", "file_abs_path": "cdk.out/NextJS-Api-development.template.json", "repo_file_path": "/cdk.out/NextJS-Api-development.template.json", "file_line_range": [1346, 1395], "resource": "AWS::ApiGateway::Method.ArticlesApiRestApisubscriptionsverifyGET4CA60961", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.APIGatewayAuthorization", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-6-api-gateway-authorizer-set", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-Api-development.template.json", "file_abs_path": "cdk.out/NextJS-Api-development.template.json", "repo_file_path": "/cdk.out/NextJS-Api-development.template.json", "file_line_range": [1441, 1478], "resource": "AWS::Logs::LogGroup.ListArticlesLambdaLogGroup188B0144", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "Layer": "API", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "WebappApi"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": null, "file_path": "/NextJS-Api-development.template.json", "file_abs_path": "cdk.out/NextJS-Api-development.template.json", "repo_file_path": "/cdk.out/NextJS-Api-development.template.json", "file_line_range": [1630, 1732], "resource": "AWS::Lambda::Function.ListArticlesLambdaFunction4BB5272A", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": {"Component": "Lambda", "Environment": "development", "Layer": "API", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "WebappApi"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.TABLE_NAME": [{"type": "parameters", "name": "SsmParameterValuenextjsdevelopmentdynamodbtablenameC96584B6F00A464EAD1953AFF4B05118Parameter", "path": "cdk.out/NextJS-Api-development.template.json", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "SsmParameterValuenextjsdevelopmentassetsbucketnameC96584B6F00A464EAD1953AFF4B05118Parameter", "path": "cdk.out/NextJS-Api-development.template.json", "attribute_key": "Default"}], "Environment.Variables.ASSETS_BUCKET_NAME": [{"type": "parameters", "name": "SsmParameterValuenextjsdevelopmentassetsbucketnameC96584B6F00A464EAD1953AFF4B05118Parameter", "path": "cdk.out/NextJS-Api-development.template.json", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-Api-development.template.json", "file_abs_path": "cdk.out/NextJS-Api-development.template.json", "repo_file_path": "/cdk.out/NextJS-Api-development.template.json", "file_line_range": [1733, 1770], "resource": "AWS::Logs::LogGroup.GetArticleLambdaLogGroupDF4D6062", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "Layer": "API", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "WebappApi"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": null, "file_path": "/NextJS-Api-development.template.json", "file_abs_path": "cdk.out/NextJS-Api-development.template.json", "repo_file_path": "/cdk.out/NextJS-Api-development.template.json", "file_line_range": [1922, 2024], "resource": "AWS::Lambda::Function.GetArticleLambdaFunction697C1731", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": {"Component": "Lambda", "Environment": "development", "Layer": "API", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "WebappApi"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.TABLE_NAME": [{"type": "parameters", "name": "SsmParameterValuenextjsdevelopmentdynamodbtablenameC96584B6F00A464EAD1953AFF4B05118Parameter", "path": "cdk.out/NextJS-Api-development.template.json", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "SsmParameterValuenextjsdevelopmentassetsbucketnameC96584B6F00A464EAD1953AFF4B05118Parameter", "path": "cdk.out/NextJS-Api-development.template.json", "attribute_key": "Default"}], "Environment.Variables.ASSETS_BUCKET_NAME": [{"type": "parameters", "name": "SsmParameterValuenextjsdevelopmentassetsbucketnameC96584B6F00A464EAD1953AFF4B05118Parameter", "path": "cdk.out/NextJS-Api-development.template.json", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-Api-development.template.json", "file_abs_path": "cdk.out/NextJS-Api-development.template.json", "repo_file_path": "/cdk.out/NextJS-Api-development.template.json", "file_line_range": [2025, 2062], "resource": "AWS::Logs::LogGroup.SubscribeLambdaLogGroupA1D318ED", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "Layer": "API", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "WebappApi"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": null, "file_path": "/NextJS-Api-development.template.json", "file_abs_path": "cdk.out/NextJS-Api-development.template.json", "repo_file_path": "/cdk.out/NextJS-Api-development.template.json", "file_line_range": [2210, 2311], "resource": "AWS::Lambda::Function.SubscribeLambdaFunctionC687D0B5", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": {"Component": "Lambda", "Environment": "development", "Layer": "API", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "WebappApi"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.TABLE_NAME": [{"type": "parameters", "name": "SsmParameterValuenextjsdevelopmentdynamodbtablenameC96584B6F00A464EAD1953AFF4B05118Parameter", "path": "cdk.out/NextJS-Api-development.template.json", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "SsmParameterValuenextjsdevelopmentdynamodbtablenameC96584B6F00A464EAD1953AFF4B05118Parameter", "path": "cdk.out/NextJS-Api-development.template.json", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-Api-development.template.json", "file_abs_path": "cdk.out/NextJS-Api-development.template.json", "repo_file_path": "/cdk.out/NextJS-Api-development.template.json", "file_line_range": [2312, 2349], "resource": "AWS::Logs::LogGroup.VerifyLambdaLogGroupE8334019", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "Layer": "API", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "WebappApi"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": null, "file_path": "/NextJS-Api-development.template.json", "file_abs_path": "cdk.out/NextJS-Api-development.template.json", "repo_file_path": "/cdk.out/NextJS-Api-development.template.json", "file_line_range": [2489, 2587], "resource": "AWS::Lambda::Function.VerifyLambdaFunctionEFB28BBF", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": {"Component": "Lambda", "Environment": "development", "Layer": "API", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "WebappApi"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.TABLE_NAME": [{"type": "parameters", "name": "SsmParameterValuenextjsdevelopmentdynamodbtablenameC96584B6F00A464EAD1953AFF4B05118Parameter", "path": "cdk.out/NextJS-Api-development.template.json", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "SsmParameterValuenextjsdevelopmentdynamodbtablenameC96584B6F00A464EAD1953AFF4B05118Parameter", "path": "cdk.out/NextJS-Api-development.template.json", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-Api-development.template.json", "file_abs_path": "cdk.out/NextJS-Api-development.template.json", "repo_file_path": "/cdk.out/NextJS-Api-development.template.json", "file_line_range": [2797, 2844], "resource": "AWS::Logs::LogGroup.AWS679f53fac002430cb0da5b7982bd2287LogGroup449FB7C2", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "Layer": "API", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "WebappApi"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-EcsClusterStack-dev.template.json", "file_abs_path": "cdk.out/NextJS-EcsClusterStack-dev.template.json", "repo_file_path": "/cdk.out/NextJS-EcsClusterStack-dev.template.json", "file_line_range": [138, 171], "resource": "AWS::Logs::LogGroup.LaunchTemplateLogGroupA94E3DC4", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Component": "ECS-Cluster", "Environment": "dev", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_26", "bc_check_id": "BC_AWS_GENERAL_15", "check_name": "Ensure all data stored in the SNS topic is encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsMasterKeyId"]}, "code_block": null, "file_path": "/NextJS-EcsClusterStack-dev.template.json", "file_abs_path": "cdk.out/NextJS-EcsClusterStack-dev.template.json", "repo_file_path": "/cdk.out/NextJS-EcsClusterStack-dev.template.json", "file_line_range": [510, 541], "resource": "AWS::SNS::Topic.AutoScalingGroupScalingNotificationsA9CF6B78", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SNSTopicEncryption", "fixed_definition": null, "entity_tags": {"Component": "ECS-Cluster", "Environment": "dev", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-15", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": null, "file_path": "/NextJS-EcsClusterStack-dev.template.json", "file_abs_path": "cdk.out/NextJS-EcsClusterStack-dev.template.json", "repo_file_path": "/cdk.out/NextJS-EcsClusterStack-dev.template.json", "file_line_range": [795, 855], "resource": "AWS::Lambda::Function.AutoScalingGroupDrainECSHookFunction13E35DE6", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": {"Component": "ECS-Cluster", "Environment": "dev", "ManagedBy": "AutoScaling", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-EcsClusterStack-dev.template.json", "file_abs_path": "cdk.out/NextJS-EcsClusterStack-dev.template.json", "repo_file_path": "/cdk.out/NextJS-EcsClusterStack-dev.template.json", "file_line_range": [856, 899], "resource": "AWS::Logs::LogGroup.AutoScalingGroupDrainECSHookFunctionLogGroupC6209E22", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Component": "ECS-Cluster", "Environment": "dev", "ManagedBy": "AutoScaling", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_26", "bc_check_id": "BC_AWS_GENERAL_15", "check_name": "Ensure all data stored in the SNS topic is encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsMasterKeyId"]}, "code_block": null, "file_path": "/NextJS-EcsClusterStack-dev.template.json", "file_abs_path": "cdk.out/NextJS-EcsClusterStack-dev.template.json", "repo_file_path": "/cdk.out/NextJS-EcsClusterStack-dev.template.json", "file_line_range": [937, 974], "resource": "AWS::SNS::Topic.AutoScalingGroupLifecycleHookDrainHookTopicF75B1498", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SNSTopicEncryption", "fixed_definition": null, "entity_tags": {"Component": "ECS-Cluster", "Environment": "dev", "ManagedBy": "AutoScaling", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-15", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/Monitoring-ComputeStack-development.template.json", "file_abs_path": "cdk.out/Monitoring-ComputeStack-development.template.json", "repo_file_path": "/cdk.out/Monitoring-ComputeStack-development.template.json", "file_line_range": [37, 66], "resource": "AWS::Logs::LogGroup.LaunchTemplateLogGroupA94E3DC4", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_26", "bc_check_id": "BC_AWS_GENERAL_15", "check_name": "Ensure all data stored in the SNS topic is encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsMasterKeyId"]}, "code_block": null, "file_path": "/Monitoring-ComputeStack-development.template.json", "file_abs_path": "cdk.out/Monitoring-ComputeStack-development.template.json", "repo_file_path": "/cdk.out/Monitoring-ComputeStack-development.template.json", "file_line_range": [351, 378], "resource": "AWS::SNS::Topic.ComputeScalingNotifications2099CF6E", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SNSTopicEncryption", "fixed_definition": null, "entity_tags": {"Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-15", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-Compute-development.template.json", "file_abs_path": "cdk.out/NextJS-Compute-development.template.json", "repo_file_path": "/cdk.out/NextJS-Compute-development.template.json", "file_line_range": [598, 639], "resource": "AWS::Logs::LogGroup.LaunchTemplateLogGroupA94E3DC4", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "Layer": "Compute", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Purpose": "NextJS", "Stack": "NextJsCompute"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_26", "bc_check_id": "BC_AWS_GENERAL_15", "check_name": "Ensure all data stored in the SNS topic is encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsMasterKeyId"]}, "code_block": null, "file_path": "/NextJS-Compute-development.template.json", "file_abs_path": "cdk.out/NextJS-Compute-development.template.json", "repo_file_path": "/cdk.out/NextJS-Compute-development.template.json", "file_line_range": [848, 887], "resource": "AWS::SNS::Topic.AutoScalingGroupScalingNotificationsA9CF6B78", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SNSTopicEncryption", "fixed_definition": null, "entity_tags": {"Environment": "development", "Layer": "Compute", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Purpose": "NextJS", "Stack": "NextJsCompute"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-15", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": null, "file_path": "/NextJS-Compute-development.template.json", "file_abs_path": "cdk.out/NextJS-Compute-development.template.json", "repo_file_path": "/cdk.out/NextJS-Compute-development.template.json", "file_line_range": [1168, 1264], "resource": "AWS::Lambda::Function.AutoScalingGroupDrainECSHookFunction13E35DE6", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": {"Component": "AutoScalingGroup", "Environment": "development", "Layer": "Compute", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Purpose": "NextJS", "Stack": "NextJsCompute"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-Compute-development.template.json", "file_abs_path": "cdk.out/NextJS-Compute-development.template.json", "repo_file_path": "/cdk.out/NextJS-Compute-development.template.json", "file_line_range": [1265, 1320], "resource": "AWS::Logs::LogGroup.AutoScalingGroupDrainECSHookFunctionLogGroupC6209E22", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Component": "AutoScalingGroup", "Environment": "development", "Layer": "Compute", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Purpose": "NextJS", "Stack": "NextJsCompute"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_26", "bc_check_id": "BC_AWS_GENERAL_15", "check_name": "Ensure all data stored in the SNS topic is encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsMasterKeyId"]}, "code_block": null, "file_path": "/NextJS-Compute-development.template.json", "file_abs_path": "cdk.out/NextJS-Compute-development.template.json", "repo_file_path": "/cdk.out/NextJS-Compute-development.template.json", "file_line_range": [1358, 1423], "resource": "AWS::SNS::Topic.AutoScalingGroupLifecycleHookDrainHookTopicF75B1498", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SNSTopicEncryption", "fixed_definition": null, "entity_tags": {"Component": "AutoScalingGroup", "Environment": "development", "Layer": "Compute", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Purpose": "NextJS", "Stack": "NextJsCompute"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-15", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/Monitoring-Vpc-development.template.json", "file_abs_path": "cdk.out/Monitoring-Vpc-development.template.json", "repo_file_path": "/cdk.out/Monitoring-Vpc-development.template.json", "file_line_range": [662, 691], "resource": "AWS::Logs::LogGroup.FlowLogGroup3E25AA51", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_260", "bc_check_id": "BC_AWS_NETWORKING_67", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/SecurityGroupIngress"]}, "code_block": null, "file_path": "/NextJS-AlbStack-development.template.json", "file_abs_path": "cdk.out/NextJS-AlbStack-development.template.json", "repo_file_path": "/cdk.out/NextJS-AlbStack-development.template.json", "file_line_range": [37, 102], "resource": "AWS::EC2::SecurityGroup.AlbSecurityGroup4CCE59C1", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SecurityGroupUnrestrictedIngress80", "fixed_definition": null, "entity_tags": {"Component": "app-security-group", "Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_91", "bc_check_id": "BC_AWS_LOGGING_22", "check_name": "Ensure the ELBv2 (Application/Network) has access logging enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/LoadBalancerAttributes"]}, "code_block": null, "file_path": "/NextJS-AlbStack-development.template.json", "file_abs_path": "cdk.out/NextJS-AlbStack-development.template.json", "repo_file_path": "/cdk.out/NextJS-AlbStack-development.template.json", "file_line_range": [135, 217], "resource": "AWS::ElasticLoadBalancingV2::LoadBalancer.ALBCAA855EE", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.ELBv2AccessLogs", "fixed_definition": null, "entity_tags": {"Component": "ALB", "Environment": "development", "ManagedBy": "CDK", "Name": "nextjs-alb-development", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-logging-22", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_103", "bc_check_id": "BC_AWS_GENERAL_43", "check_name": "Ensure that Load Balancer Listener is using at least TLS v1.2", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/Protocol", "Properties/SslPolicy"]}, "code_block": null, "file_path": "/NextJS-AlbStack-development.template.json", "file_abs_path": "cdk.out/NextJS-AlbStack-development.template.json", "repo_file_path": "/cdk.out/NextJS-AlbStack-development.template.json", "file_line_range": [218, 238], "resource": "AWS::ElasticLoadBalancingV2::Listener.ALBHttpListener2FDE4CC9", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.ALBListenerTLS12", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-43", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_2", "bc_check_id": "BC_AWS_NETWORKING_29", "check_name": "Ensure ALB protocol is HTTPS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/Protocol", "Properties/DefaultActions"]}, "code_block": null, "file_path": "/NextJS-AlbStack-development.template.json", "file_abs_path": "cdk.out/NextJS-AlbStack-development.template.json", "repo_file_path": "/cdk.out/NextJS-AlbStack-development.template.json", "file_line_range": [218, 238], "resource": "AWS::ElasticLoadBalancingV2::Listener.ALBHttpListener2FDE4CC9", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.ALBListenerHTTPS", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-29", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-Vpc-development.template.json", "file_abs_path": "cdk.out/NextJS-Vpc-development.template.json", "repo_file_path": "/cdk.out/NextJS-Vpc-development.template.json", "file_line_range": [640, 669], "resource": "AWS::Logs::LogGroup.FlowLogGroup3E25AA51", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_136", "bc_check_id": "BC_AWS_GENERAL_53", "check_name": "Ensure that ECR repositories are encrypted using KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/EncryptionConfiguration/EncryptionType"]}, "code_block": null, "file_path": "/NextJS-Vpc-development.template.json", "file_abs_path": "cdk.out/NextJS-Vpc-development.template.json", "repo_file_path": "/cdk.out/NextJS-Vpc-development.template.json", "file_line_range": [670, 713], "resource": "AWS::ECR::Repository.EcrRepository4D7B3EE1", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.ECRRepositoryEncrypted", "fixed_definition": null, "entity_tags": {"Application": "NextJS", "Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "SharedResource": "true"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-ecr-repositories-are-encrypted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_51", "bc_check_id": "BC_AWS_GENERAL_24", "check_name": "Ensure ECR Image Tags are immutable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ImageTagMutability"]}, "code_block": null, "file_path": "/NextJS-Vpc-development.template.json", "file_abs_path": "cdk.out/NextJS-Vpc-development.template.json", "repo_file_path": "/cdk.out/NextJS-Vpc-development.template.json", "file_line_range": [670, 713], "resource": "AWS::ECR::Repository.EcrRepository4D7B3EE1", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.ECRImmutableTags", "fixed_definition": null, "entity_tags": {"Application": "NextJS", "Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "SharedResource": "true"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-24", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/LoggingConfiguration"]}, "code_block": null, "file_path": "/Monitoring-SSM-development.template.json", "file_abs_path": "cdk.out/Monitoring-SSM-development.template.json", "repo_file_path": "/cdk.out/Monitoring-SSM-development.template.json", "file_line_range": [37, 96], "resource": "AWS::S3::Bucket.ScriptsBucket40FEB4B1", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.S3AccessLogs", "fixed_definition": null, "entity_tags": {"aws-cdk:auto-delete-objects": "true", "aws-cdk:cr-owned:scripts:4a6cae36": "true", "Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure the S3 bucket has versioning enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VersioningConfiguration/Status"]}, "code_block": null, "file_path": "/Monitoring-SSM-development.template.json", "file_abs_path": "cdk.out/Monitoring-SSM-development.template.json", "repo_file_path": "/cdk.out/Monitoring-SSM-development.template.json", "file_line_range": [37, 96], "resource": "AWS::S3::Bucket.ScriptsBucket40FEB4B1", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.S3Versioning", "fixed_definition": null, "entity_tags": {"aws-cdk:auto-delete-objects": "true", "aws-cdk:cr-owned:scripts:4a6cae36": "true", "Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": null, "file_path": "/Monitoring-SSM-development.template.json", "file_abs_path": "cdk.out/Monitoring-SSM-development.template.json", "repo_file_path": "/cdk.out/Monitoring-SSM-development.template.json", "file_line_range": [437, 500], "resource": "AWS::Lambda::Function.CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C81C01536", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": {"Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/Monitoring-SSM-development.template.json", "file_abs_path": "cdk.out/Monitoring-SSM-development.template.json", "repo_file_path": "/cdk.out/Monitoring-SSM-development.template.json", "file_line_range": [501, 540], "resource": "AWS::Logs::LogGroup.CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CLogGroup817B64E9", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_27", "bc_check_id": "BC_AWS_GENERAL_16", "check_name": "Ensure all data stored in the SQS queue is encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsMasterKeyId"]}, "code_block": null, "file_path": "/NextJS-AutoDeployStack-development.template.json", "file_abs_path": "cdk.out/NextJS-AutoDeployStack-development.template.json", "repo_file_path": "/cdk.out/NextJS-AutoDeployStack-development.template.json", "file_line_range": [37, 70], "resource": "AWS::SQS::Queue.DeadLetterQueue9F481546", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SQSQueueEncryption", "fixed_definition": null, "entity_tags": {"Component": "ECR-AutoDeploy", "Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-AutoDeployStack-development.template.json", "file_abs_path": "cdk.out/NextJS-AutoDeployStack-development.template.json", "repo_file_path": "/cdk.out/NextJS-AutoDeployStack-development.template.json", "file_line_range": [131, 164], "resource": "AWS::Logs::LogGroup.DeployLambdaLogGroup0064E22E", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Component": "ECR-AutoDeploy", "Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": null, "file_path": "/NextJS-AutoDeployStack-development.template.json", "file_abs_path": "cdk.out/NextJS-AutoDeployStack-development.template.json", "repo_file_path": "/cdk.out/NextJS-AutoDeployStack-development.template.json", "file_line_range": [307, 400], "resource": "AWS::Lambda::Function.DeployLambdaFunction3C0D1E4E", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": {"Component": "Lambda", "Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_260", "bc_check_id": "BC_AWS_NETWORKING_67", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/SecurityGroupIngress"]}, "code_block": null, "file_path": "/NextJS-AlbStack-dev.template.json", "file_abs_path": "cdk.out/NextJS-AlbStack-dev.template.json", "repo_file_path": "/cdk.out/NextJS-AlbStack-dev.template.json", "file_line_range": [37, 100], "resource": "AWS::EC2::SecurityGroup.AlbSecurityGroup4CCE59C1", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SecurityGroupUnrestrictedIngress80", "fixed_definition": null, "entity_tags": {"Component": "app-security-group", "Environment": "dev", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_91", "bc_check_id": "BC_AWS_LOGGING_22", "check_name": "Ensure the ELBv2 (Application/Network) has access logging enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/LoadBalancerAttributes"]}, "code_block": null, "file_path": "/NextJS-AlbStack-dev.template.json", "file_abs_path": "cdk.out/NextJS-AlbStack-dev.template.json", "repo_file_path": "/cdk.out/NextJS-AlbStack-dev.template.json", "file_line_range": [133, 211], "resource": "AWS::ElasticLoadBalancingV2::LoadBalancer.ALBCAA855EE", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.ELBv2AccessLogs", "fixed_definition": null, "entity_tags": {"Component": "ALB", "Environment": "dev", "ManagedBy": "CDK", "Name": "nextjs-alb-dev", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-logging-22", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_103", "bc_check_id": "BC_AWS_GENERAL_43", "check_name": "Ensure that Load Balancer Listener is using at least TLS v1.2", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/Protocol", "Properties/SslPolicy"]}, "code_block": null, "file_path": "/NextJS-AlbStack-dev.template.json", "file_abs_path": "cdk.out/NextJS-AlbStack-dev.template.json", "repo_file_path": "/cdk.out/NextJS-AlbStack-dev.template.json", "file_line_range": [212, 232], "resource": "AWS::ElasticLoadBalancingV2::Listener.ALBHttpListener2FDE4CC9", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.ALBListenerTLS12", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-43", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_2", "bc_check_id": "BC_AWS_NETWORKING_29", "check_name": "Ensure ALB protocol is HTTPS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/Protocol", "Properties/DefaultActions"]}, "code_block": null, "file_path": "/NextJS-AlbStack-dev.template.json", "file_abs_path": "cdk.out/NextJS-AlbStack-dev.template.json", "repo_file_path": "/cdk.out/NextJS-AlbStack-dev.template.json", "file_line_range": [212, 232], "resource": "AWS::ElasticLoadBalancingV2::Listener.ALBHttpListener2FDE4CC9", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.ALBListenerHTTPS", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-29", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/LoggingConfiguration"]}, "code_block": null, "file_path": "/NextJS-DynamoDbStack-development.template.json", "file_abs_path": "cdk.out/NextJS-DynamoDbStack-development.template.json", "repo_file_path": "/cdk.out/NextJS-DynamoDbStack-development.template.json", "file_line_range": [37, 115], "resource": "AWS::S3::Bucket.AccessLogsBucket83982689", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.S3AccessLogs", "fixed_definition": null, "entity_tags": {"aws-cdk:auto-delete-objects": "true", "Environment": "development", "Layer": "Storage", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "nextjs", "Stack": "WebappDynamoDB"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_119", "bc_check_id": "BC_AWS_GENERAL_52", "check_name": "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/SSESpecification/SSEEnabled", "Properties/SSESpecification/KMSMasterKeyId"]}, "code_block": null, "file_path": "/NextJS-DynamoDbStack-development.template.json", "file_abs_path": "cdk.out/NextJS-DynamoDbStack-development.template.json", "repo_file_path": "/cdk.out/NextJS-DynamoDbStack-development.template.json", "file_line_range": [558, 698], "resource": "AWS::DynamoDB::Table.ArticlesTableA6125DFA", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.DynamoDBTablesEncrypted", "fixed_definition": null, "entity_tags": {"Application": "Portfolio", "DataClassification": "Public", "Environment": "development", "Layer": "Storage", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "nextjs", "Purpose": "Article storage for portfolio Next.js application", "Stack": "WebappDynamoDB", "TableName": "articles"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-52", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-VpcStack-dev.template.json", "file_abs_path": "cdk.out/NextJS-VpcStack-dev.template.json", "repo_file_path": "/cdk.out/NextJS-VpcStack-dev.template.json", "file_line_range": [662, 691], "resource": "AWS::Logs::LogGroup.FlowLogGroup3E25AA51", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "dev", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-Edge-development.template.json", "file_abs_path": "cdk.out/NextJS-Edge-development.template.json", "repo_file_path": "/cdk.out/NextJS-Edge-development.template.json", "file_line_range": [38, 75], "resource": "AWS::Logs::LogGroup.ValidationLambdaLogGroup3FCDB42E", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "Layer": "Edge", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "NextJsEdge"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": null, "file_path": "/NextJS-Edge-development.template.json", "file_abs_path": "cdk.out/NextJS-Edge-development.template.json", "repo_file_path": "/cdk.out/NextJS-Edge-development.template.json", "file_line_range": [186, 279], "resource": "AWS::Lambda::Function.ValidationLambdaFunction514E215D", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": {"Component": "Lambda", "Environment": "development", "Layer": "Edge", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "NextJsEdge"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-Edge-development.template.json", "file_abs_path": "cdk.out/NextJS-Edge-development.template.json", "repo_file_path": "/cdk.out/NextJS-Edge-development.template.json", "file_line_range": [280, 333], "resource": "AWS::Logs::LogGroup.CertificateProviderLogGroup73C26C50", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Component": "ACM-Certificate", "DomainName": "dev.nelsonlamounier.com", "Environment": "development", "Layer": "Edge", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "NextJsEdge"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": null, "file_path": "/NextJS-Edge-development.template.json", "file_abs_path": "cdk.out/NextJS-Edge-development.template.json", "repo_file_path": "/cdk.out/NextJS-Edge-development.template.json", "file_line_range": [473, 560], "resource": "AWS::Lambda::Function.CertificateCertificateProviderframeworkonEvent6DA84EF4", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": {"Component": "ACM-Certificate", "DomainName": "dev.nelsonlamounier.com", "Environment": "development", "Layer": "Edge", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "NextJsEdge"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-Edge-development.template.json", "file_abs_path": "cdk.out/NextJS-Edge-development.template.json", "repo_file_path": "/cdk.out/NextJS-Edge-development.template.json", "file_line_range": [884, 931], "resource": "AWS::Logs::LogGroup.AWS679f53fac002430cb0da5b7982bd2287LogGroup449FB7C2", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "Layer": "Edge", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "NextJsEdge"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_86", "bc_check_id": "BC_AWS_LOGGING_20", "check_name": "Ensure CloudFront Distribution has Access Logging enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DistributionConfig/Logging/Bucket"]}, "code_block": null, "file_path": "/NextJS-Edge-development.template.json", "file_abs_path": "cdk.out/NextJS-Edge-development.template.json", "repo_file_path": "/cdk.out/NextJS-Edge-development.template.json", "file_line_range": [1131, 1364], "resource": "AWS::CloudFront::Distribution.Distribution20DB6340", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudfrontDistributionLogging", "fixed_definition": null, "entity_tags": {"Component": "CloudFront", "Environment": "development", "Layer": "Edge", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "NextJsEdge"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-20", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-Edge-development.template.json", "file_abs_path": "cdk.out/NextJS-Edge-development.template.json", "repo_file_path": "/cdk.out/NextJS-Edge-development.template.json", "file_line_range": [1365, 1402], "resource": "AWS::Logs::LogGroup.DnsAliasProviderLogGroup8527BD12", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "Layer": "Edge", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "NextJsEdge"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": null, "file_path": "/NextJS-Edge-development.template.json", "file_abs_path": "cdk.out/NextJS-Edge-development.template.json", "repo_file_path": "/cdk.out/NextJS-Edge-development.template.json", "file_line_range": [1518, 1597], "resource": "AWS::Lambda::Function.DnsAliasProviderframeworkonEvent2724F166", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": {"Environment": "development", "Layer": "Edge", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "NextJsEdge"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/Shared-VpcStack-dev.template 2.json", "file_abs_path": "cdk.out/Shared-VpcStack-dev.template 2.json", "repo_file_path": "/cdk.out/Shared-VpcStack-dev.template 2.json", "file_line_range": [512, 523], "resource": "AWS::Logs::LogGroup.FlowLogGroup3E25AA51", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_260", "bc_check_id": "BC_AWS_NETWORKING_67", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/SecurityGroupIngress"]}, "code_block": null, "file_path": "/NextJS-Networking-development.template.json", "file_abs_path": "cdk.out/NextJS-Networking-development.template.json", "repo_file_path": "/cdk.out/NextJS-Networking-development.template.json", "file_line_range": [37, 124], "resource": "AWS::EC2::SecurityGroup.AlbSecurityGroup4CCE59C1", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SecurityGroupUnrestrictedIngress80", "fixed_definition": null, "entity_tags": {"Component": "app-security-group", "Environment": "development", "Layer": "Networking", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "NextJsNetworking"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_91", "bc_check_id": "BC_AWS_LOGGING_22", "check_name": "Ensure the ELBv2 (Application/Network) has access logging enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/LoadBalancerAttributes"]}, "code_block": null, "file_path": "/NextJS-Networking-development.template.json", "file_abs_path": "cdk.out/NextJS-Networking-development.template.json", "repo_file_path": "/cdk.out/NextJS-Networking-development.template.json", "file_line_range": [125, 211], "resource": "AWS::ElasticLoadBalancingV2::LoadBalancer.ALBCAA855EE", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.ELBv2AccessLogs", "fixed_definition": null, "entity_tags": {"Component": "ALB", "Environment": "development", "Layer": "Networking", "ManagedBy": "CDK", "Name": "nextjs-alb-development", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "NextJsNetworking"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-logging-22", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_103", "bc_check_id": "BC_AWS_GENERAL_43", "check_name": "Ensure that Load Balancer Listener is using at least TLS v1.2", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/Protocol", "Properties/SslPolicy"]}, "code_block": null, "file_path": "/NextJS-Networking-development.template.json", "file_abs_path": "cdk.out/NextJS-Networking-development.template.json", "repo_file_path": "/cdk.out/NextJS-Networking-development.template.json", "file_line_range": [212, 242], "resource": "AWS::ElasticLoadBalancingV2::Listener.ALBHttpsListener8A32E9A3", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.ALBListenerTLS12", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-43", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_103", "bc_check_id": "BC_AWS_GENERAL_43", "check_name": "Ensure that Load Balancer Listener is using at least TLS v1.2", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/Protocol", "Properties/SslPolicy"]}, "code_block": null, "file_path": "/NextJS-Networking-development.template.json", "file_abs_path": "cdk.out/NextJS-Networking-development.template.json", "repo_file_path": "/cdk.out/NextJS-Networking-development.template.json", "file_line_range": [243, 263], "resource": "AWS::ElasticLoadBalancingV2::Listener.ALBHttpListener2FDE4CC9", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.ALBListenerTLS12", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-43", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_2", "bc_check_id": "BC_AWS_NETWORKING_29", "check_name": "Ensure ALB protocol is HTTPS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/Protocol", "Properties/DefaultActions"]}, "code_block": null, "file_path": "/NextJS-Networking-development.template.json", "file_abs_path": "cdk.out/NextJS-Networking-development.template.json", "repo_file_path": "/cdk.out/NextJS-Networking-development.template.json", "file_line_range": [243, 263], "resource": "AWS::ElasticLoadBalancingV2::Listener.ALBHttpListener2FDE4CC9", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.ALBListenerHTTPS", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-29", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-Networking-development.template.json", "file_abs_path": "cdk.out/NextJS-Networking-development.template.json", "repo_file_path": "/cdk.out/NextJS-Networking-development.template.json", "file_line_range": [319, 356], "resource": "AWS::Logs::LogGroup.AcmValidationLambdaLogGroup53DC0E52", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "Layer": "Networking", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "NextJsNetworking"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": null, "file_path": "/NextJS-Networking-development.template.json", "file_abs_path": "cdk.out/NextJS-Networking-development.template.json", "repo_file_path": "/cdk.out/NextJS-Networking-development.template.json", "file_line_range": [467, 560], "resource": "AWS::Lambda::Function.AcmValidationLambdaFunctionECDE0A4C", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": {"Component": "Lambda", "Environment": "development", "Layer": "Networking", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "NextJsNetworking"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-Networking-development.template.json", "file_abs_path": "cdk.out/NextJS-Networking-development.template.json", "repo_file_path": "/cdk.out/NextJS-Networking-development.template.json", "file_line_range": [561, 614], "resource": "AWS::Logs::LogGroup.AlbCertificateProviderLogGroup69BD96E1", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Component": "ACM-Certificate", "DomainName": "dev.nelsonlamounier.com", "Environment": "development", "Layer": "Networking", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "NextJsNetworking"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": null, "file_path": "/NextJS-Networking-development.template.json", "file_abs_path": "cdk.out/NextJS-Networking-development.template.json", "repo_file_path": "/cdk.out/NextJS-Networking-development.template.json", "file_line_range": [754, 841], "resource": "AWS::Lambda::Function.AlbCertificateCertificateProviderframeworkonEventB11D6981", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": {"Component": "ACM-Certificate", "DomainName": "dev.nelsonlamounier.com", "Environment": "development", "Layer": "Networking", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "NextJsNetworking"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_27", "bc_check_id": "BC_AWS_GENERAL_16", "check_name": "Ensure all data stored in the SQS queue is encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsMasterKeyId"]}, "code_block": null, "file_path": "/Monitoring-EbsLifecycle-development.template.json", "file_abs_path": "cdk.out/Monitoring-EbsLifecycle-development.template.json", "repo_file_path": "/cdk.out/Monitoring-EbsLifecycle-development.template.json", "file_line_range": [41, 78], "resource": "AWS::SQS::Queue.LambdaDlq3949784F", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SQSQueueEncryption", "fixed_definition": null, "entity_tags": {"Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_27", "bc_check_id": "BC_AWS_GENERAL_16", "check_name": "Ensure all data stored in the SQS queue is encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsMasterKeyId"]}, "code_block": null, "file_path": "/Monitoring-EbsLifecycle-development.template.json", "file_abs_path": "cdk.out/Monitoring-EbsLifecycle-development.template.json", "repo_file_path": "/cdk.out/Monitoring-EbsLifecycle-development.template.json", "file_line_range": [115, 152], "resource": "AWS::SQS::Queue.EventBridgeDlq4776D248", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SQSQueueEncryption", "fixed_definition": null, "entity_tags": {"Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/Monitoring-EbsLifecycle-development.template.json", "file_abs_path": "cdk.out/Monitoring-EbsLifecycle-development.template.json", "repo_file_path": "/cdk.out/Monitoring-EbsLifecycle-development.template.json", "file_line_range": [213, 242], "resource": "AWS::Logs::LogGroup.EbsDetachLambdaLogGroup95ACAE5B", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": null, "file_path": "/Monitoring-EbsLifecycle-development.template.json", "file_abs_path": "cdk.out/Monitoring-EbsLifecycle-development.template.json", "repo_file_path": "/cdk.out/Monitoring-EbsLifecycle-development.template.json", "file_line_range": [381, 471], "resource": "AWS::Lambda::Function.EbsDetachLambdaFunctionF75CD4F6", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": {"Component": "Lambda", "Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/LoggingConfiguration"]}, "code_block": null, "file_path": "/NextJS-Data-development.template.json", "file_abs_path": "cdk.out/NextJS-Data-development.template.json", "repo_file_path": "/cdk.out/NextJS-Data-development.template.json", "file_line_range": [37, 115], "resource": "AWS::S3::Bucket.AccessLogsBucket83982689", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.S3AccessLogs", "fixed_definition": null, "entity_tags": {"aws-cdk:auto-delete-objects": "true", "Environment": "development", "Layer": "Data", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "NextJsData"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_119", "bc_check_id": "BC_AWS_GENERAL_52", "check_name": "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/SSESpecification/SSEEnabled", "Properties/SSESpecification/KMSMasterKeyId"]}, "code_block": null, "file_path": "/NextJS-Data-development.template.json", "file_abs_path": "cdk.out/NextJS-Data-development.template.json", "repo_file_path": "/cdk.out/NextJS-Data-development.template.json", "file_line_range": [580, 721], "resource": "AWS::DynamoDB::Table.PortfolioTable7756BCB1", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.DynamoDBTablesEncrypted", "fixed_definition": null, "entity_tags": {"Application": "Portfolio", "DataClassification": "PII-Email", "Environment": "development", "Layer": "Data", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "nextjs", "Purpose": "Personal portfolio data storage - articles and email subscriptions", "Stack": "NextJsData", "TableName": "personal-portfolio"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-52", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-Data-development.template.json", "file_abs_path": "cdk.out/NextJS-Data-development.template.json", "repo_file_path": "/cdk.out/NextJS-Data-development.template.json", "file_line_range": [923, 978], "resource": "AWS::Logs::LogGroup.AWS679f53fac002430cb0da5b7982bd2287LogGroup449FB7C2", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "Layer": "Data", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "NextJsData"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-EcsClusterStack-development.template.json", "file_abs_path": "cdk.out/NextJS-EcsClusterStack-development.template.json", "repo_file_path": "/cdk.out/NextJS-EcsClusterStack-development.template.json", "file_line_range": [164, 197], "resource": "AWS::Logs::LogGroup.LaunchTemplateLogGroupA94E3DC4", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Component": "ECS-Cluster", "Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_26", "bc_check_id": "BC_AWS_GENERAL_15", "check_name": "Ensure all data stored in the SNS topic is encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsMasterKeyId"]}, "code_block": null, "file_path": "/NextJS-EcsClusterStack-development.template.json", "file_abs_path": "cdk.out/NextJS-EcsClusterStack-development.template.json", "repo_file_path": "/cdk.out/NextJS-EcsClusterStack-development.template.json", "file_line_range": [536, 567], "resource": "AWS::SNS::Topic.AutoScalingGroupScalingNotificationsA9CF6B78", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SNSTopicEncryption", "fixed_definition": null, "entity_tags": {"Component": "ECS-Cluster", "Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-15", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": null, "file_path": "/NextJS-EcsClusterStack-development.template.json", "file_abs_path": "cdk.out/NextJS-EcsClusterStack-development.template.json", "repo_file_path": "/cdk.out/NextJS-EcsClusterStack-development.template.json", "file_line_range": [829, 913], "resource": "AWS::Lambda::Function.AutoScalingGroupDrainECSHookFunction13E35DE6", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": {"Component": "ECS-Cluster", "Environment": "development", "ManagedBy": "AutoScaling", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-EcsClusterStack-development.template.json", "file_abs_path": "cdk.out/NextJS-EcsClusterStack-development.template.json", "repo_file_path": "/cdk.out/NextJS-EcsClusterStack-development.template.json", "file_line_range": [914, 957], "resource": "AWS::Logs::LogGroup.AutoScalingGroupDrainECSHookFunctionLogGroupC6209E22", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Component": "ECS-Cluster", "Environment": "development", "ManagedBy": "AutoScaling", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_26", "bc_check_id": "BC_AWS_GENERAL_15", "check_name": "Ensure all data stored in the SNS topic is encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsMasterKeyId"]}, "code_block": null, "file_path": "/NextJS-EcsClusterStack-development.template.json", "file_abs_path": "cdk.out/NextJS-EcsClusterStack-development.template.json", "repo_file_path": "/cdk.out/NextJS-EcsClusterStack-development.template.json", "file_line_range": [995, 1048], "resource": "AWS::SNS::Topic.AutoScalingGroupLifecycleHookDrainHookTopicF75B1498", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SNSTopicEncryption", "fixed_definition": null, "entity_tags": {"Component": "ECS-Cluster", "Environment": "development", "ManagedBy": "AutoScaling", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-15", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/Monitoring-ComputeStack-dev.template.json", "file_abs_path": "cdk.out/Monitoring-ComputeStack-dev.template.json", "repo_file_path": "/cdk.out/Monitoring-ComputeStack-dev.template.json", "file_line_range": [37, 66], "resource": "AWS::Logs::LogGroup.LaunchTemplateLogGroupA94E3DC4", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "dev", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_26", "bc_check_id": "BC_AWS_GENERAL_15", "check_name": "Ensure all data stored in the SNS topic is encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsMasterKeyId"]}, "code_block": null, "file_path": "/Monitoring-ComputeStack-dev.template.json", "file_abs_path": "cdk.out/Monitoring-ComputeStack-dev.template.json", "repo_file_path": "/cdk.out/Monitoring-ComputeStack-dev.template.json", "file_line_range": [351, 378], "resource": "AWS::SNS::Topic.ComputeScalingNotifications2099CF6E", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SNSTopicEncryption", "fixed_definition": null, "entity_tags": {"Environment": "dev", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-15", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/Monitoring-VpcStack-dev.template.json", "file_abs_path": "cdk.out/Monitoring-VpcStack-dev.template.json", "repo_file_path": "/cdk.out/Monitoring-VpcStack-dev.template.json", "file_line_range": [640, 669], "resource": "AWS::Logs::LogGroup.FlowLogGroup3E25AA51", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "dev", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_27", "bc_check_id": "BC_AWS_GENERAL_16", "check_name": "Ensure all data stored in the SQS queue is encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsMasterKeyId"]}, "code_block": null, "file_path": "/Monitoring-EbsLifecycleStack-development.template.json", "file_abs_path": "cdk.out/Monitoring-EbsLifecycleStack-development.template.json", "repo_file_path": "/cdk.out/Monitoring-EbsLifecycleStack-development.template.json", "file_line_range": [41, 78], "resource": "AWS::SQS::Queue.LambdaDlq3949784F", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SQSQueueEncryption", "fixed_definition": null, "entity_tags": {"Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_27", "bc_check_id": "BC_AWS_GENERAL_16", "check_name": "Ensure all data stored in the SQS queue is encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsMasterKeyId"]}, "code_block": null, "file_path": "/Monitoring-EbsLifecycleStack-development.template.json", "file_abs_path": "cdk.out/Monitoring-EbsLifecycleStack-development.template.json", "repo_file_path": "/cdk.out/Monitoring-EbsLifecycleStack-development.template.json", "file_line_range": [115, 152], "resource": "AWS::SQS::Queue.EventBridgeDlq4776D248", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SQSQueueEncryption", "fixed_definition": null, "entity_tags": {"Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/Monitoring-EbsLifecycleStack-development.template.json", "file_abs_path": "cdk.out/Monitoring-EbsLifecycleStack-development.template.json", "repo_file_path": "/cdk.out/Monitoring-EbsLifecycleStack-development.template.json", "file_line_range": [213, 242], "resource": "AWS::Logs::LogGroup.EbsDetachLambdaLogGroup95ACAE5B", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": null, "file_path": "/Monitoring-EbsLifecycleStack-development.template.json", "file_abs_path": "cdk.out/Monitoring-EbsLifecycleStack-development.template.json", "repo_file_path": "/cdk.out/Monitoring-EbsLifecycleStack-development.template.json", "file_line_range": [385, 477], "resource": "AWS::Lambda::Function.EbsDetachLambdaFunctionF75CD4F6", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": {"Component": "Lambda", "Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-VpcStack-development.template.json", "file_abs_path": "cdk.out/NextJS-VpcStack-development.template.json", "repo_file_path": "/cdk.out/NextJS-VpcStack-development.template.json", "file_line_range": [662, 691], "resource": "AWS::Logs::LogGroup.FlowLogGroup3E25AA51", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-ApiStack-development.template.json", "file_abs_path": "cdk.out/NextJS-ApiStack-development.template.json", "repo_file_path": "/cdk.out/NextJS-ApiStack-development.template.json", "file_line_range": [38, 75], "resource": "AWS::Logs::LogGroup.ArticlesApiAccessLogs46ED8D57", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "Layer": "API", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "nextjs", "Stack": "WebappApi"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_120", "bc_check_id": "BC_AWS_GENERAL_128", "check_name": "Ensure API Gateway caching is enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/CacheClusterEnabled"]}, "code_block": null, "file_path": "/NextJS-ApiStack-development.template.json", "file_abs_path": "cdk.out/NextJS-ApiStack-development.template.json", "repo_file_path": "/cdk.out/NextJS-ApiStack-development.template.json", "file_line_range": [138, 203], "resource": "AWS::ApiGateway::Stage.ArticlesApiRestApiDeploymentStageapi08C84436", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.APIGatewayCacheEnable", "fixed_definition": null, "entity_tags": {"Component": "ApiGateway", "Environment": "development", "Layer": "API", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "nextjs", "Stack": "WebappApi"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-api-gateway-caching-is-enabled", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_73", "bc_check_id": "BC_AWS_LOGGING_15", "check_name": "Ensure API Gateway has X-Ray Tracing enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/TracingEnabled"]}, "code_block": null, "file_path": "/NextJS-ApiStack-development.template.json", "file_abs_path": "cdk.out/NextJS-ApiStack-development.template.json", "repo_file_path": "/cdk.out/NextJS-ApiStack-development.template.json", "file_line_range": [138, 203], "resource": "AWS::ApiGateway::Stage.ArticlesApiRestApiDeploymentStageapi08C84436", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.APIGatewayXray", "fixed_definition": null, "entity_tags": {"Component": "ApiGateway", "Environment": "development", "Layer": "API", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "nextjs", "Stack": "WebappApi"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-15", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/Shared-VpcStack-dev.template.json", "file_abs_path": "cdk.out/Shared-VpcStack-dev.template.json", "repo_file_path": "/cdk.out/Shared-VpcStack-dev.template.json", "file_line_range": [534, 545], "resource": "AWS::Logs::LogGroup.FlowLogGroup3E25AA51", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_27", "bc_check_id": "BC_AWS_GENERAL_16", "check_name": "Ensure all data stored in the SQS queue is encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsMasterKeyId"]}, "code_block": null, "file_path": "/Monitoring-EbsLifecycleStack-dev.template.json", "file_abs_path": "cdk.out/Monitoring-EbsLifecycleStack-dev.template.json", "repo_file_path": "/cdk.out/Monitoring-EbsLifecycleStack-dev.template.json", "file_line_range": [41, 78], "resource": "AWS::SQS::Queue.LambdaDlq3949784F", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SQSQueueEncryption", "fixed_definition": null, "entity_tags": {"Environment": "dev", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_27", "bc_check_id": "BC_AWS_GENERAL_16", "check_name": "Ensure all data stored in the SQS queue is encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsMasterKeyId"]}, "code_block": null, "file_path": "/Monitoring-EbsLifecycleStack-dev.template.json", "file_abs_path": "cdk.out/Monitoring-EbsLifecycleStack-dev.template.json", "repo_file_path": "/cdk.out/Monitoring-EbsLifecycleStack-dev.template.json", "file_line_range": [115, 152], "resource": "AWS::SQS::Queue.EventBridgeDlq4776D248", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SQSQueueEncryption", "fixed_definition": null, "entity_tags": {"Environment": "dev", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/Monitoring-EbsLifecycleStack-dev.template.json", "file_abs_path": "cdk.out/Monitoring-EbsLifecycleStack-dev.template.json", "repo_file_path": "/cdk.out/Monitoring-EbsLifecycleStack-dev.template.json", "file_line_range": [213, 242], "resource": "AWS::Logs::LogGroup.EbsDetachLambdaLogGroup95ACAE5B", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "dev", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": null, "file_path": "/Monitoring-EbsLifecycleStack-dev.template.json", "file_abs_path": "cdk.out/Monitoring-EbsLifecycleStack-dev.template.json", "repo_file_path": "/cdk.out/Monitoring-EbsLifecycleStack-dev.template.json", "file_line_range": [381, 471], "resource": "AWS::Lambda::Function.EbsDetachLambdaFunctionF75CD4F6", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": {"Component": "Lambda", "Environment": "dev", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-NodeExporterTaskDefStack-dev.template.json", "file_abs_path": "cdk.out/NextJS-NodeExporterTaskDefStack-dev.template.json", "repo_file_path": "/cdk.out/NextJS-NodeExporterTaskDefStack-dev.template.json", "file_line_range": [37, 74], "resource": "AWS::Logs::LogGroup.LogGroupF5B46931", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Component": "NodeExporter-TaskDefinition", "Environment": "dev", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Purpose": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/AssumeRolePolicyDocument/Statement"]}, "code_block": null, "file_path": "/Org-DnsRoleStack-production.template.json", "file_abs_path": "cdk.out/Org-DnsRoleStack-production.template.json", "repo_file_path": "/cdk.out/Org-DnsRoleStack-production.template.json", "file_line_range": [37, 89], "resource": "AWS::IAM::Role.DnsValidationRoleF74A8CD8", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": {"Component": "DNS-Validation-Role", "Environment": "production", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Org", "Purpose": "Cross-Account-ACM-Validation"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/Monitoring-InfraStack-dev.template.json", "file_abs_path": "cdk.out/Monitoring-InfraStack-dev.template.json", "repo_file_path": "/cdk.out/Monitoring-InfraStack-dev.template.json", "file_line_range": [163, 174], "resource": "AWS::Logs::LogGroup.ComputeLogGroup1A40385B", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_46", "bc_check_id": "BC_AWS_SECRETS_1", "check_name": "Ensure no hard-coded secrets exist in EC2 user data", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/UserData"]}, "code_block": null, "file_path": "/Monitoring-InfraStack-dev.template.json", "file_abs_path": "cdk.out/Monitoring-InfraStack-dev.template.json", "repo_file_path": "/cdk.out/Monitoring-InfraStack-dev.template.json", "file_line_range": [301, 377], "resource": "AWS::EC2::Instance.ComputeInstance734F92C2", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.EC2Credentials", "fixed_definition": null, "entity_tags": {"Application": "Prometheus-Grafana", "Name": "Monitoring-dev-instance", "Purpose": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"ImageId": [{"type": "parameters", "name": "SsmParameterValueawsserviceamiamazonlinuxlatestal2023amikernel61x8664C96584B6F00A464EAD1953AFF4B05118Parameter", "path": "cdk.out/Monitoring-InfraStack-dev.template.json", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_136", "bc_check_id": "BC_AWS_GENERAL_53", "check_name": "Ensure that ECR repositories are encrypted using KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/EncryptionConfiguration/EncryptionType"]}, "code_block": null, "file_path": "/NextJS-EcrStack-development.template.json", "file_abs_path": "cdk.out/NextJS-EcrStack-development.template.json", "repo_file_path": "/cdk.out/NextJS-EcrStack-development.template.json", "file_line_range": [37, 76], "resource": "AWS::ECR::Repository.Repository71B74A19", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.ECRRepositoryEncrypted", "fixed_definition": null, "entity_tags": {"Application": "NextJS", "Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-ecr-repositories-are-encrypted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_51", "bc_check_id": "BC_AWS_GENERAL_24", "check_name": "Ensure ECR Image Tags are immutable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ImageTagMutability"]}, "code_block": null, "file_path": "/NextJS-EcrStack-development.template.json", "file_abs_path": "cdk.out/NextJS-EcrStack-development.template.json", "repo_file_path": "/cdk.out/NextJS-EcrStack-development.template.json", "file_line_range": [37, 76], "resource": "AWS::ECR::Repository.Repository71B74A19", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.ECRImmutableTags", "fixed_definition": null, "entity_tags": {"Application": "NextJS", "Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-24", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/PortfolioVpcStack-dev.template.json", "file_abs_path": "cdk.out/PortfolioVpcStack-dev.template.json", "repo_file_path": "/cdk.out/PortfolioVpcStack-dev.template.json", "file_line_range": [620, 649], "resource": "AWS::Logs::LogGroup.VpcConstructFlowLogGroup9B1721BD", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "dev", "ManagedBy": "CDK", "Owner": "team", "Project": "cdk-monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_136", "bc_check_id": "BC_AWS_GENERAL_53", "check_name": "Ensure that ECR repositories are encrypted using KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/EncryptionConfiguration/EncryptionType"]}, "code_block": null, "file_path": "/NextJS-EcrStack-dev.template.json", "file_abs_path": "cdk.out/NextJS-EcrStack-dev.template.json", "repo_file_path": "/cdk.out/NextJS-EcrStack-dev.template.json", "file_line_range": [37, 94], "resource": "AWS::ECR::Repository.Repository71B74A19", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.ECRRepositoryEncrypted", "fixed_definition": null, "entity_tags": {"Application": "NextJS", "Environment": "dev", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-ecr-repositories-are-encrypted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_51", "bc_check_id": "BC_AWS_GENERAL_24", "check_name": "Ensure ECR Image Tags are immutable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ImageTagMutability"]}, "code_block": null, "file_path": "/NextJS-EcrStack-dev.template.json", "file_abs_path": "cdk.out/NextJS-EcrStack-dev.template.json", "repo_file_path": "/cdk.out/NextJS-EcrStack-dev.template.json", "file_line_range": [37, 94], "resource": "AWS::ECR::Repository.Repository71B74A19", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.ECRImmutableTags", "fixed_definition": null, "entity_tags": {"Application": "NextJS", "Environment": "dev", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-24", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/MonitoringInfraStack-dev.template.json", "file_abs_path": "cdk.out/MonitoringInfraStack-dev.template.json", "repo_file_path": "/cdk.out/MonitoringInfraStack-dev.template.json", "file_line_range": [195, 224], "resource": "AWS::Logs::LogGroup.ComputeLogGroup1A40385B", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "dev", "ManagedBy": "CDK", "Owner": "team", "Project": "cdk-monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_46", "bc_check_id": "BC_AWS_SECRETS_1", "check_name": "Ensure no hard-coded secrets exist in EC2 user data", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/UserData"]}, "code_block": null, "file_path": "/MonitoringInfraStack-dev.template.json", "file_abs_path": "cdk.out/MonitoringInfraStack-dev.template.json", "repo_file_path": "/cdk.out/MonitoringInfraStack-dev.template.json", "file_line_range": [369, 461], "resource": "AWS::EC2::Instance.ComputeInstance734F92C2", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.EC2Credentials", "fixed_definition": null, "entity_tags": {"Application": "Prometheus-Grafana", "Environment": "dev", "ManagedBy": "CDK", "Name": "monitoring-dev-instance", "Owner": "team", "Project": "cdk-monitoring", "Purpose": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"ImageId": [{"type": "parameters", "name": "SsmParameterValueawsserviceamiamazonlinuxlatestal2023amikernel61x8664C96584B6F00A464EAD1953AFF4B05118Parameter", "path": "cdk.out/MonitoringInfraStack-dev.template.json", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/Shared-Vpc-development.template.json", "file_abs_path": "cdk.out/Shared-Vpc-development.template.json", "repo_file_path": "/cdk.out/Shared-Vpc-development.template.json", "file_line_range": [640, 669], "resource": "AWS::Logs::LogGroup.FlowLogGroup3E25AA51", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Shared"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_136", "bc_check_id": "BC_AWS_GENERAL_53", "check_name": "Ensure that ECR repositories are encrypted using KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/EncryptionConfiguration/EncryptionType"]}, "code_block": null, "file_path": "/Shared-Vpc-development.template.json", "file_abs_path": "cdk.out/Shared-Vpc-development.template.json", "repo_file_path": "/cdk.out/Shared-Vpc-development.template.json", "file_line_range": [670, 713], "resource": "AWS::ECR::Repository.EcrRepository4D7B3EE1", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.ECRRepositoryEncrypted", "fixed_definition": null, "entity_tags": {"Application": "NextJS", "Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Shared", "SharedResource": "true"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-ecr-repositories-are-encrypted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_51", "bc_check_id": "BC_AWS_GENERAL_24", "check_name": "Ensure ECR Image Tags are immutable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ImageTagMutability"]}, "code_block": null, "file_path": "/Shared-Vpc-development.template.json", "file_abs_path": "cdk.out/Shared-Vpc-development.template.json", "repo_file_path": "/cdk.out/Shared-Vpc-development.template.json", "file_line_range": [670, 713], "resource": "AWS::ECR::Repository.EcrRepository4D7B3EE1", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.ECRImmutableTags", "fixed_definition": null, "entity_tags": {"Application": "NextJS", "Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "Shared", "SharedResource": "true"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-24", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/Monitoring-Ec2Stack-dev.template.json", "file_abs_path": "cdk.out/Monitoring-Ec2Stack-dev.template.json", "repo_file_path": "/cdk.out/Monitoring-Ec2Stack-dev.template.json", "file_line_range": [37, 48], "resource": "AWS::Logs::LogGroup.InstanceLogGroupB49DDDE8", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_46", "bc_check_id": "BC_AWS_SECRETS_1", "check_name": "Ensure no hard-coded secrets exist in EC2 user data", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/UserData"]}, "code_block": null, "file_path": "/Monitoring-Ec2Stack-dev.template.json", "file_abs_path": "cdk.out/Monitoring-Ec2Stack-dev.template.json", "repo_file_path": "/cdk.out/Monitoring-Ec2Stack-dev.template.json", "file_line_range": [142, 208], "resource": "AWS::EC2::Instance.MonitoringInstanceF98CDC02", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.EC2Credentials", "fixed_definition": null, "entity_tags": {"Application": "Prometheus-Grafana", "Name": "monitoring-instance", "Purpose": "Monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"ImageId": [{"type": "parameters", "name": "SsmParameterValueawsserviceamiamazonlinuxlatestal2023amikernel61x8664C96584B6F00A464EAD1953AFF4B05118Parameter", "path": "cdk.out/Monitoring-Ec2Stack-dev.template.json", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-Application-development.template.json", "file_abs_path": "cdk.out/NextJS-Application-development.template.json", "repo_file_path": "/cdk.out/NextJS-Application-development.template.json", "file_line_range": [68, 105], "resource": "AWS::Logs::LogGroup.TaskDefinitionLogGroupDAF57CBA", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "Layer": "Application", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "NextJsApplication"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-Application-development.template.json", "file_abs_path": "cdk.out/NextJS-Application-development.template.json", "repo_file_path": "/cdk.out/NextJS-Application-development.template.json", "file_line_range": [388, 425], "resource": "AWS::Logs::LogGroup.PromtailLogGroup206C6726", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "Layer": "Application", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "NextJsApplication"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-Application-development.template.json", "file_abs_path": "cdk.out/NextJS-Application-development.template.json", "repo_file_path": "/cdk.out/NextJS-Application-development.template.json", "file_line_range": [1053, 1090], "resource": "AWS::Logs::LogGroup.NodeExporterLogGroup831E4D32", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "development", "Layer": "Application", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS", "Stack": "NextJsApplication"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_27", "bc_check_id": "BC_AWS_GENERAL_16", "check_name": "Ensure all data stored in the SQS queue is encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsMasterKeyId"]}, "code_block": null, "file_path": "/NextJS-AutoDeployStack-dev.template.json", "file_abs_path": "cdk.out/NextJS-AutoDeployStack-dev.template.json", "repo_file_path": "/cdk.out/NextJS-AutoDeployStack-dev.template.json", "file_line_range": [37, 70], "resource": "AWS::SQS::Queue.DeadLetterQueue9F481546", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SQSQueueEncryption", "fixed_definition": null, "entity_tags": {"Component": "ECR-AutoDeploy", "Environment": "dev", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-AutoDeployStack-dev.template.json", "file_abs_path": "cdk.out/NextJS-AutoDeployStack-dev.template.json", "repo_file_path": "/cdk.out/NextJS-AutoDeployStack-dev.template.json", "file_line_range": [131, 164], "resource": "AWS::Logs::LogGroup.DeployLambdaLogGroup0064E22E", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Component": "ECR-AutoDeploy", "Environment": "dev", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": null, "file_path": "/NextJS-AutoDeployStack-dev.template.json", "file_abs_path": "cdk.out/NextJS-AutoDeployStack-dev.template.json", "repo_file_path": "/cdk.out/NextJS-AutoDeployStack-dev.template.json", "file_line_range": [303, 394], "resource": "AWS::Lambda::Function.DeployLambdaFunction3C0D1E4E", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": {"Component": "Lambda", "Environment": "dev", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/PortfolioVpcStack-dev.template 2.json", "file_abs_path": "cdk.out/PortfolioVpcStack-dev.template 2.json", "repo_file_path": "/cdk.out/PortfolioVpcStack-dev.template 2.json", "file_line_range": [714, 743], "resource": "AWS::Logs::LogGroup.FlowLogGroup3E25AA51", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "dev", "ManagedBy": "CDK", "Owner": "team", "Project": "cdk-monitoring"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-TaskDefStack-dev.template.json", "file_abs_path": "cdk.out/NextJS-TaskDefStack-dev.template.json", "repo_file_path": "/cdk.out/NextJS-TaskDefStack-dev.template.json", "file_line_range": [37, 70], "resource": "AWS::Logs::LogGroup.TaskDefinitionLogGroupDAF57CBA", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Component": "ECS-TaskDefinition", "Environment": "dev", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyId"]}, "code_block": null, "file_path": "/NextJS-TaskDefStack-development.template.json", "file_abs_path": "cdk.out/NextJS-TaskDefStack-development.template.json", "repo_file_path": "/cdk.out/NextJS-TaskDefStack-development.template.json", "file_line_range": [37, 70], "resource": "AWS::Logs::LogGroup.TaskDefinitionLogGroupDAF57CBA", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Component": "ECS-TaskDefinition", "Environment": "development", "ManagedBy": "CDK", "Owner": "Nelson Lamounier", "Project": "NextJS"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": null}]}, "summary": {"passed": 1619, "failed": 137, "skipped": 0, "parsing_errors": 0, "resource_count": 877, "checkov_version": "3.2.500"}}