# @format
# Next.js Application Configuration
#
# Non-sensitive environment variables for the Next.js container.
# Maps directly from the ECS Task Definition `containerEnvironment` block
# in application-stack.ts.
#
# Sensitive values (DYNAMODB_TABLE_NAME, ASSETS_BUCKET_NAME, NEXT_PUBLIC_API_URL)
# are injected via Kubernetes Secrets (resolved from SSM during deploy).

apiVersion: v1
kind: ConfigMap
metadata:
  name: nextjs-config
  namespace: nextjs-app
  labels:
    app: nextjs
    app.kubernetes.io/part-of: nextjs
data:
  # Core Next.js
  NODE_ENV: "production"
  PORT: "3000"
  NEXT_TELEMETRY_DISABLED: "1"
  HOSTNAME: "0.0.0.0"

  # DynamoDB GSI names (server-side direct queries)
  DYNAMODB_GSI1_NAME: "GSI1"
  DYNAMODB_GSI2_NAME: "GSI2"

  # OpenTelemetry (Alloy sidecar present in Pod)
  OTEL_SDK_DISABLED: "false"
  OTEL_EXPORTER_OTLP_ENDPOINT: "http://localhost:4317"
  OTEL_SERVICE_NAME: "nextjs-app"
  OTEL_RESOURCE_ATTRIBUTES: "service.namespace=nextjs"
